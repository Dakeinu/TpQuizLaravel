import{u as x,y as A,b as _,r as z,x as Q,l as E,c as k,o as d,d as m,e,k as C,v as N,t as f,F as j,i as L,s as B}from"./vendor.20d4d45b.js";import{_ as I,A as u,u as D}from"./index.2a1fb1ab.js";import{A as M}from"./question.4dac6f8d.js";const S={components:{AppQuestion:M},setup(){const h=x(),s=D(),t=A().params.quizId,b=_(!0),o=z([]),c=_(""),i=Q(()=>o.reduce((n,l)=>n+l.earnings,0)),g=n=>{const l=o.findIndex(r=>r.id===n);o.splice(l,1)},q=()=>{const n=Date.now().toString()+Math.random().toString();o.push({id:n,label:"",earnings:0,answer:"NONE",choices:[]})},y=async()=>{if(o.length<=0)return s("error","You must add at least one question.");if(!o.every(a=>a.label.trim().length>0))return s("error","All questions must have a label.");if(!o.every(a=>a.earnings>0))return s("error","All questions must have an earning.");if(!o.every(a=>a.choices.length>0))return s("error","All questions must have at least one choice.");if(!o.every(a=>a.choices.every(w=>w.label.trim().length>0)))return s("error","All choices must have a label.");if(!o.every(a=>a.answer!=="NONE"))return s("error","All questions must have an answer. Please select one");try{await u.editQuiz(t,{label:c.value,published:!1,questions:o}),s("success","Quiz updated!"),h.push("/admin")}catch(a){s("error",a.message)}};return E(async()=>{try{const n=await u.getQuiz(t);if(n.published){s("error","You cannot edit a published quiz."),h.push("/admin");return}const l=await u.getQuestions(t);for(const r of l){const v=await u.getChoices(r.id);r.choices=v,o.push(r)}c.value=n.label,b.value=!1}catch(n){s("error",n.message)}}),{loading:b,label:c,questions:o,addQuestion:q,totalEarnings:i,submit:y,onremove:g}}},F={key:0,class:"row"},H=e("div",{class:"col"},[e("div",{class:"d-flex justify-content-center"},[e("div",{class:"spinner-border",role:"status"},[e("span",{class:"visually-hidden"},"Loading...")])])],-1),O=[H],P={key:1},R={class:"row mb-4"},T={class:"col"},U={class:"d-flex justify-content-between align-items-center"},V=e("h4",null,"Edit quiz",-1),Y={class:"row"},G={class:"col"},J={class:"form-group"},K=e("label",null,"Quiz label",-1),W={class:"row mb-4"},X={class:"col"},Z={class:"d-flex justify-content-between mb-4"};function $(h,s,p,t,b,o){const c=k("app-question");return t.loading?(d(),m("div",F,O)):(d(),m("div",P,[e("div",R,[e("div",T,[e("div",U,[V,e("button",{class:"btn btn-success",onClick:s[0]||(s[0]=(...i)=>t.submit&&t.submit(...i))},"Update")])])]),e("div",Y,[e("div",G,[e("div",J,[K,C(e("input",{type:"text",class:"form-control","onUpdate:modelValue":s[1]||(s[1]=i=>t.label=i),placeholder:"Enter a label for the quiz"},null,512),[[N,t.label]])])])]),e("div",W,[e("div",X,[e("div",Z,[e("b",null,"Number of questions: "+f(t.questions.length),1),e("b",null,"Total earnings: "+f(t.totalEarnings),1)]),(d(!0),m(j,null,L(t.questions,i=>(d(),B(c,{key:i.id,question:i,onremove:t.onremove},null,8,["question","onremove"]))),128)),e("button",{class:"btn btn-secondary text-center w-100",onClick:s[2]||(s[2]=(...i)=>t.addQuestion&&t.addQuestion(...i))},"Add a question")])])]))}var ne=I(S,[["render",$]]);export{ne as default};
