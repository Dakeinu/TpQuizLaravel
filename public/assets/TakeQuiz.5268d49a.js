import{y,u as k,r as w,l as z,x as p,o as r,d,e as s,t as l,F as b,i as v,h as x,k as Q,z as j}from"./vendor.20d4d45b.js";import{_ as q,A as _,u as E}from"./index.2a1fb1ab.js";const N={setup(){const{params:m}=y(),n=m.quizId,u=k(),t=E(),e=w({});console.log(e),z(async()=>{_.getQuiz(n).then(a=>{if(Object.assign(e,a),!e.published)return t("error","Quiz is not published yet."),u.push("/");_.getQuestions(n).then(o=>{e.questions=o,e.questions.forEach(h=>{_.getChoices(h.id).then(g=>{h.choices=g,h.selected=""})})})})});const f=p(()=>e.questions.reduce((a,o)=>a+o.earnings,0)),i=p(()=>{let a=!0;for(let o of(e==null?void 0:e.questions)||[])if(o.selected===""){a=!1;break}return a});return{quiz:e,totalEarnings:f,submit:async()=>{const a=e.questions.map(o=>({answer:o.selected,question_id:o.id}));try{await _.submitQuiz(e.id,a),t("success","Quiz submitted successfully."),u.push("/")}catch(o){if(o.response.status===400)return t("error","You've already completed the quiz"),u.push("/");t("error",o.message)}},done:i}}},V={class:"row mb-4"},B={class:"col"},F={class:"row"},R={class:"col"},A={class:"card mb-2"},C={class:"card-body"},D={class:"d-flex justify-content-between align-items-start"},I={class:"card-title"},M={class:"form-check"},T=["name","id","value","onUpdate:modelValue"],U=["for"],L={class:"row"},O={class:"col"},P=["disabled"];function S(m,n,u,t,e,f){return r(),d(b,null,[s("div",V,[s("div",B,[s("h3",null,l(t.quiz.label),1)])]),s("div",F,[s("div",R,[(r(!0),d(b,null,v(t.quiz.questions,i=>(r(),d("div",A,[s("div",C,[s("div",D,[s("div",I,l(i.label),1),s("span",null,[x(l(i.earnings)+" / ",1),s("b",null,l(t.totalEarnings),1)])]),(r(!0),d(b,null,v(i.choices,c=>(r(),d("div",M,[Q(s("input",{class:"form-check-input",type:"radio",name:`q-${i.id}`,id:`choice-${c.id}`,value:c.id,"onUpdate:modelValue":a=>i.selected=a},null,8,T),[[j,i.selected]]),s("label",{class:"form-check-label",for:`choice-${c.id}`},l(c.label),9,U)]))),256))])]))),256))])]),s("div",L,[s("div",O,[s("button",{class:"btn btn-success w-100",disabled:!t.done,onClick:n[0]||(n[0]=(...i)=>t.submit&&t.submit(...i))},"Finish",8,P)])])],64)}var G=q(N,[["render",S]]);export{G as default};
